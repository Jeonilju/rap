package com.klt.connectior;

import java.io.UnsupportedEncodingException;
import java.security.NoSuchAlgorithmException;

import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.methods.HttpRequestBase;
import org.apache.http.entity.StringEntity;

import android.util.Log;

import com.google.gson.Gson;
import com.klt.data.UserInfo;
import com.klt.setting.SimpleSHA1;

public class KLTAPIs_Point {

	private static final String TAG = "KTLTAPIs_Point";
	
	/** 포인트 사용 내역 */
	public static HttpRequestBase getUesingPoint(String username, String password)
			throws UnsupportedEncodingException {
		
		UserInfo info = new UserInfo();
		info.username = username;
		info.password = password;
		
		String json = new Gson().toJson(info);
		Log.i(TAG, "json: " + json);
		HttpPost httpPost = new HttpPost(KLTHttpClient.getBaseURL() + "/point/log/");
		httpPost.setHeader("Content-Type", "application/json");
		StringEntity entity = new StringEntity(json, "utf-8");
		httpPost.setEntity(entity);

		return httpPost;
	}
	
	/**  포인트 충전 내역 */
	public static HttpRequestBase getPointChargeList(String username, String password) throws UnsupportedEncodingException{
		String url_str = KLTHttpClient.getBaseURL() + "/point/" + username +"/charge/";
		
		UserInfo info = new UserInfo();
		info.username = username;
		info.password = password;
		
		String json = new Gson().toJson(info);
		HttpPost httpPost = new HttpPost(url_str);
		httpPost.setHeader("Content-Type", "application/json");
		StringEntity entity = new StringEntity(json, "utf-8");
		httpPost.setEntity(entity);

		return httpPost;
	}
	
	/**  포인트 조회 */
	public static HttpRequestBase getMyPoint(String username, String password) throws UnsupportedEncodingException{
		String url_str = KLTHttpClient.getBaseURL() + "/point/info/";
		
		UserInfo info = new UserInfo();
		info.username = username;
		info.password = password;
		
		String json = new Gson().toJson(info);
		
		HttpPost httpPost = new HttpPost(url_str);
		httpPost.setHeader("Content-Type", "application/json");
		StringEntity entity = new StringEntity(json, "utf-8");
		httpPost.setEntity(entity);

		return httpPost;
	}
	
	/** 포인트 충전  
	 * TODO 여기서 호출될 API가 아님
	 * */
	public static HttpRequestBase chargingPoint(int money, String username, String password) throws UnsupportedEncodingException, NoSuchAlgorithmException{
		UserInfo info = new UserInfo();
		info.username = username;
		info.password = password;
		info.money = money;
		info.encrypt_key = SimpleSHA1.SHA1("sadari" + username);
		
		String json = new Gson().toJson(info);
		
		Log.e(TAG, "ID2: " + username + ", PW: " + password);
		
		HttpPost httpPost = new HttpPost(KLTHttpClient.getBaseURL() + "/point/" + username + "/");
		httpPost.setHeader("Content-Type", "application/json");
		StringEntity entity = new StringEntity(json, "utf-8");
		httpPost.setEntity(entity);

		return httpPost;
	}
	
	/** 포인트 출금  */
	public static HttpRequestBase PointWithdraw(int money) throws UnsupportedEncodingException, NoSuchAlgorithmException{
		UserInfo info = new UserInfo();
		info.money = money;

		String json = new Gson().toJson(info);
		HttpPost httpPost = new HttpPost(KLTHttpClient.getBaseURL() + "/point/withdraw/begin/");
		httpPost.setHeader("Content-Type", "application/json");
		StringEntity entity = new StringEntity(json, "utf-8");
		httpPost.setEntity(entity);

		return httpPost;
	}
}
